# Bitaxe Monitor Configuration with Discord Bot
# Copy this to config.yaml and update with your settings

devices:
  - name: "bitaxe-1"
    ip: "192.168.1.149"
    enabled: true

  - name: "bitaxe-2"
    ip: "192.168.1.44"
    enabled: true

  - name: "bitaxe-3"
    ip: "192.168.1.78"
    enabled: true

  - name: "bitaxe-4"
    ip: "192.168.1.236"
    enabled: true

logging:
  poll_interval: 10               # Data collection interval (10s recommended)
  database_path: "./data/metrics.db"
  log_level: "INFO"

safety:
  max_temp_warning: 65            # °C - Log warning
  max_temp_shutdown: 70           # °C - Emergency alert
  min_hashrate_warning: 400       # GH/s - Alert if hashrate drops

# Discord Bot Configuration
discord:
  enabled: true
  token: "${DISCORD_BOT_TOKEN}"   # Set via environment variable
  command_prefix: "!"             # Commands will be: !status, !report, etc.

  # Optional: Restrict bot to specific channels (leave empty for all channels)
  allowed_channels: []
    # - 1234567890123456789       # Uncomment and add your channel ID

  # Auto-reporting: Posts summary every hour
  auto_report:
    enabled: true
    channel_name: "swarm"             # For reference only
    channel_id: 1234567890123456789   # REQUIRED: Your Discord channel ID (see setup guide)
    schedule: "0 * * * *"             # Every hour on the hour (24 reports/day)
    include_charts: true              # Attach hashrate/temp charts

    # Graph settings
    graph_lookback_hours: 12          # Show last 12 hours in graphs
    show_moving_averages: true        # Include 1h and 24h MA lines

    # Stats display
    show_1h_average: true             # Show 1-hour rolling average
    show_24h_average: true            # Show 24-hour rolling average

  # Chart generation settings
  charts:
    dpi: 150                      # Image quality: 72=draft, 150=good, 300=print
    style: "dark_background"      # Matches Discord dark theme
    figsize: [14, 7]             # Width x Height in inches
    cache_ttl: 300                # Cache charts for 5 minutes

  # Command-specific settings
  commands:
    status_cooldown: 10           # Seconds between uses per user
    report_cooldown: 60           # Seconds between uses per user
    report_max_hours: 336         # Max lookback (14 days)
    miner_cooldown: 30            # Seconds between uses per user

  # Weekly report: Posts detailed 7-day report
  weekly_report:
    enabled: true
    channel_name: "swarm"
    channel_id: 1234567890123456789   # Your Discord channel ID
    schedule: "0 12 * * 1"            # Monday at 12:00 UTC
    include_charts: true
    graph_lookback_hours: 168         # 7 days

  # Offline miner alerts: Alerts when a miner goes down
  alerts:
    enabled: true
    channel_id: 1234567890123456789   # Channel for alerts
    user_id_to_tag: 1234567890123456789  # Discord user ID to mention (optional)
    check_interval_minutes: 1         # Check every 1 minute
    offline_threshold_minutes: 2      # Consider offline after 2 min without data

  # Remote control commands (!restart, !clock, !voltage, !fan)
  control:
    enabled: true
    admin_role_id: 0                  # Discord role ID required (0 = no restriction)
    admin_role_name: "Miner Admin"    # Display name for the role
    # Safety limits to prevent damage
    min_frequency: 400                # MHz - minimum allowed frequency
    max_frequency: 650                # MHz - maximum allowed frequency
    min_voltage: 1000                 # mV - minimum core voltage
    max_voltage: 1300                 # mV - maximum core voltage
    min_fan_speed: 0                  # % - minimum fan speed
    max_fan_speed: 100                # % - maximum fan speed
